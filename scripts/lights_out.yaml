lights_off:
  sequence:
    - service: switch.turn_off
      data_template:
        entity_id: >
         {{ [states.switch.attic_stairs_light, 
             states.switch.back_door_light, 
             states.switch.backyard_flood_lights,
             states.switch.bathroom_fan,
             states.switch.bathroom_vanity,
             states.switch.bedroom_fan,
             states.switch.desk_lamp_switch,
             states.switch.dining_room_light,
             states.switch.family_room_fan,
             states.switch.front_door_lights,
             states.switch.garage_outside_light,
             states.switch.ginas_bathroom_light,
             states.switch.ginas_room_light,
             states.switch.guest_bathroom_light_switch,
             states.switch.home_audio_system,
             states.switch.kitchen_door_inside_light,
             states.switch.kitchen_door_outside_light,
             states.switch.kitchen_lights,
             states.switch.laundry_light,
             states.switch.office_light_switch,
             states.switch.patio_lights,
             states.switch.upstairs_room_light,
             states.switch.utility_room_light] 
         | rejectattr('state','equalto','off')
         | map(attribute='entity_id' ) 
         | join(', ') }}
    - service: light.turn_off
      data_template:
        entity_id: >
         {{ [states.light.bedroom_lights,
             states.light.family_room_lights,
             states.light.attic_light,
             states.light.living_room_lights] 
         | rejectattr('state','equalto','off')
         | map(attribute='entity_id' ) 
         | join(', ') }}
